version: '3.8'

services:
  backend:
    build: ./backend
    container_name: encrypt_backend
    ports:
      - "8000:8000"
    environment:
      - ALLOWED_ORIGINS=*
    restart: always

  frontend:
    build: ./frontend
    container_name: encrypt_frontend
    ports:
      - "5173:80"
    depends_on:
      - backend
    # This ENV VAR is only effective IF passed during build time (ARGS) for Vite/React,
    # OR if we had a runtime injection script. 
    # Since standard Vite bakes env at build time, we should use ARG in Dockerfile or build context.
    # However, to keep it simple, letting user's browser access 'localhost:8000' works for local docker.
    # If remote, user needs to rebuild image with VITE_API_URL set.
    # We will assume local docker usage for now.
    
    # Correct approach for dynamic IP using Docker Compose ONLY is hard for static assets.
    # The user asked: "frontend có thể nhận cả ip nữa".
    # This implies we should be able to configure it.
    # For now, we rely on the default behavior (or .env file at build).
    restart: always
